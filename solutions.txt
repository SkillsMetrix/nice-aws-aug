package com.app;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

import com.amazonaws.services.sns.AmazonSNSClient;
import com.amazonaws.services.sns.model.PublishRequest;
import com.amazonaws.services.sns.model.SubscribeRequest;

@SpringBootApplication
@RestController
public class SpringSNSApp {
	public static void main(String[] args) {
		SpringApplication.run(SpringSNSApp.class, args);
	}
	@Autowired
	private AmazonSNSClient snsClient;
	 private String TOPIC_ARN="arn:aws:sns:us-east-1:115024895830:amar-sns-topic";
	
	@GetMapping("/addsubscribe/{email}")
	public String addSubscribe(@PathVariable String email) {
		SubscribeRequest request= new SubscribeRequest(TOPIC_ARN,"email",email);
		snsClient.subscribe(request);
		return "subscription request sent..... waiting for the confirmation";
		
	}
	@GetMapping("/sendnotification")
	public String publishMessage() {
		PublishRequest request= new PublishRequest(TOPIC_ARN,"Welcome to our channel....");
		snsClient.publish(request);
		return "Notification Sent..!";
		
	}

}
------

package com.app;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.amazonaws.regions.Regions;
import com.amazonaws.services.sns.AmazonSNSClient;
import com.amazonaws.services.sns.AmazonSNSClientBuilder;

@Configuration
public class AwsSnsConfig {
	@Bean
	public AmazonSNSClient snsClient() {
		return (AmazonSNSClient)AmazonSNSClientBuilder.standard()
				.withRegion(Regions.US_EAST_1).build();
	}

}
